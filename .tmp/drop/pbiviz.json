{"visual":{"name":"vImage","displayName":"VImage","guid":"vImage9A4E60DA8D8644E6856BE871F0717518","visualClassName":"ImageVisual","version":"1.0.0","description":"Custom data-bound image control","supportUrl":"","gitHubUrl":""},"apiVersion":"2.5.0","author":{"name":"Duc Thang Ho","email":"ducthangho@gmail.com"},"assets":{"icon":"assets/icon.png"},"externalJS":["node_modules/powerbi-visuals-utils-dataviewutils/lib/index.js"],"style":"style/visual.less","capabilities":{"dataRoles":[{"displayName":"Image url","displayNameKey":"settingsImageUrl","name":"category","kind":"GroupingOrMeasure"}],"objects":{"imageOptions":{"displayName":"Image options","displayNameKey":"settingsImageOptions","properties":{"circle":{"displayName":"Circle","displayNameKey":"settingsCircle","type":{"bool":true}},"borderColor":{"displayName":"Border color","displayNameKey":"settingsBorderColor","type":{"fill":{"solid":{"color":true}}}},"borderWidth":{"displayName":"Border width","displayNameKey":"settingsBorderWidth","type":{"integer":true}}}}},"dataViewMappings":[{"conditions":[{"category":{"max":1}}],"categorical":{"categories":{"for":{"in":"category"},"dataReductionAlgorithm":{"top":{}}}}}]},"stringResources":{"en-US":{"settingsImageUrl":"Image url","settingsImageOptions":"Image options","settingsCircle":"Circle","settingsBorderColor":"Border color","settingsBorderWidth":"Border width"}},"content":{"js":"var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t,r){void 0===e&&(e=[]);var n=e;return i(n),t&&(n.identityFields=t),r&&(n.source=r),n}function i(e,t){e.grouped=t?function(){return t}:function(){return r(e)}}function r(e){for(var t,i=[],r=0,n=e.length;n>r;r++){var a=e[r];if(!t||t.identity!==a.identity){if(t={values:[]},a.identity){t.identity=a.identity;var o=a.source;void 0!==o.groupName?t.name=o.groupName:o.displayName&&(t.name=o.displayName)}i.push(t)}t.values.push(a)}return i}e.createValueColumns=t,e.setGrouped=i,e.groupValues=r}(t=e.DataViewTransform||(e.DataViewTransform={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t){if(!e||!e.length)return-1;var i=e[0];if(i.values&&i.values.length>0)for(var n=0,a=i.values.length;a>n;++n){var o=i.values[n];if(o&&o.source&&r(o.source,t))return n}return-1}function i(e,t){if(e&&e.length)for(var i=0,n=e.length;n>i;i++)if(r(e[i].source,t))return i;return-1}function r(e,t){var i=e.roles;return i&&i[t]}function n(e,t){return null!=e&&null!=e.metadata&&e.metadata.columns&&e.metadata.columns.some(function(e){return e.roles&&void 0!==e.roles[t]})}function a(e,t){return e&&e.source&&e.source.roles&&e.source.roles[t]===!0}e.getMeasureIndexOfRole=t,e.getCategoryIndexOfRole=i,e.hasRole=r,e.hasRoleInDataView=n,e.hasRoleInValueColumn=a}(t=e.DataRoleHelper||(e.DataRoleHelper={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e,t,i){if(!e)return i;var r=e[t];return void 0===r?i:r}function i(e,i,r){var n=t(e,i);return n&&n.solid?n.solid.color:r}e.getValue=t,e.getFillColorByPropertyName=i}(t=e.DataViewObject||(e.DataViewObject={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){function i(t,i,r){return t?e.DataViewObject.getValue(t[i.objectName],i.propertyName,r):r}function r(e,t,i){return e&&e[t]?e[t]:i}function n(e,t,r){var n=i(e,t);return n&&n.solid?n.solid.color:r}function a(e,t,r){var n=i(e,t,r);return n&&n.solid?n.solid.color:void 0===n||null===n||\"object\"==typeof n&&!n.solid?r:n}t.getValue=i,t.getObject=r,t.getFillColor=n,t.getCommonValue=a}(t=e.DataViewObjects||(e.DataViewObjects={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i,r=e.extensibility.utils.dataview.DataRoleHelper;!function(e){function t(e,t,i){if(e.categories&&e.categories.length>0){var n=e.categories[0];return n.source&&r.hasRole(n.source,t)&&r.hasRole(n.source,i)}return!1}function i(e){return void 0!==e.groupName?e.groupName:e.queryName}function n(e){var t=o(e);return null!=t&&t.imageUrl===!0}function a(e){var t=o(e);return null!=t&&t.webUrl===!0}function o(e){return e&&e.type&&e.type.misc}function s(e){return e&&e.metadata&&e.metadata.columns&&e.metadata.columns.length?e.metadata.columns.some(function(e){return n(e)===!0}):!1}e.categoryIsAlsoSeriesRole=t,e.getSeriesName=i,e.isImageUrlColumn=n,e.isWebUrlColumn=a,e.getMiscellaneousTypeDescriptor=o,e.hasImageUrlColumn=s}(i=t.converterHelper||(t.converterHelper={}))}(i=t.dataview||(t.dataview={}))}(i=t.utils||(t.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){function t(e){return/^https?:\\/\\/.+\\.(gif|jpg|png|svg)$/i.test(e)||/^data:image\\/(gif|jpeg|png|svg\\+xml);base64,/i.test(e)}function i(e,t){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(i.readyState===this.HEADERS_RECEIVED){var e=i.getResponseHeader(\"Content-Type\"),r=[\"image/png\",\"image/jpeg\",\"image/gif\",\"image/svg+xml\"];return r.indexOf(e)>-1?t(!0,e):t(!1,e)}},i.open(\"HEAD\",e,!0),i.send()}e.isImageUrlAllowed=t,e.isFileImage=i}(t=e.validationHelper||(e.validationHelper={}))}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function t(){}return t.getDefault=function(){return new this},t.createPropertyIdentifier=function(e,t){return{objectName:e,propertyName:t}},t.parse=function(t){var i,r=this.getDefault();if(!t||!t.metadata||!t.metadata.objects)return r;i=r.getProperties();for(var n in i)for(var a in i[n]){var o=r[n][a];r[n][a]=e.DataViewObjects.getCommonValue(t.metadata.objects,i[n][a],o)}return r},t.isPropertyEnumerable=function(e){return!t.InnumerablePropertyPrefix.test(e)},t.enumerateObjectInstances=function(e,t){var i=e&&e[t.objectName];if(!i)return[];var r={objectName:t.objectName,selector:null,properties:{}};for(var n in i)i.hasOwnProperty(n)&&(r.properties[n]=i[n]);return{instances:[r]}},t.prototype.getProperties=function(){var e=this,i={},r=Object.keys(this);return r.forEach(function(r){if(t.isPropertyEnumerable(r)){var n=Object.keys(e[r]);i[r]={},n.forEach(function(e){t.isPropertyEnumerable(r)&&(i[r][e]=t.createPropertyIdentifier(r,e))})}}),i},t}();t.InnumerablePropertyPrefix=/^_/,e.DataViewObjectsParser=t}(t=e.dataview||(e.dataview={}))}(t=e.utils||(e.utils={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),__decorate=this&&this.__decorate||function(e,t,i,r){var n,a=arguments.length,o=3>a?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(o=(3>a?n(o):a>3?n(t,i,o):n(t,i))||o);return a>3&&o&&Object.defineProperty(t,i,o),o},__metadata=this&&this.__metadata||function(e,t){return\"object\"==typeof Reflect&&\"function\"==typeof Reflect.metadata?Reflect.metadata(e,t):void 0},powerbi;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){\"use strict\";function i(){return function(e,t,i){return{value:function(){try{return i.value.apply(this,arguments)}catch(e){throw console.error(e),e}}}}}var r=e.extensibility.utils.dataview.DataViewObjectsParser;t.logExceptions=i;var n=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.imageOptions=new a,t}return __extends(t,e),t}(r);t.VisualSettings=n;var a=function(){function e(){this.circle=!1,this.borderColor=\"#fff\",this.borderWidth=5}return e}();t.imageSettings=a}(i=t.vImage9A4E60DA8D8644E6856BE871F0717518||(t.vImage9A4E60DA8D8644E6856BE871F0717518={}))}(i=t.visual||(t.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){\"use strict\";function t(e){return e=\"double\"===n?e.replace(/\"/g,\"'\"):e.replace(/'/g,'\"'),e=e.replace(/>\\s{1,}</g,\"><\"),e=e.replace(/\\s{2,}/g,\" \"),e.replace(a,encodeURIComponent)}function i(){var e='\"',t=\"'\";return{level1:\"double\"===n?e:t,level2:\"double\"===n?t:e}}function r(e,t){return 0===e.lastIndexOf(t,0)}var n=\"double\",a=/[\\r\\n%#()<>?\\[\\\\\\]^`{|}]/g,o=(i(),function(){function i(e){this.target=e.element,this.updateCount=0}return i.prototype.update=function(e){for(this.settings=i.parseSettings(e&&e.dataViews&&e.dataViews[0]);this.target.firstChild;)this.target.removeChild(this.target.firstChild);var n,a=e.dataViews[0];if(a&&a.categorical&&void 0!=a.categorical.categories?n=a.categorical.categories[0].values[0]:a&&a.categorical&&void 0!=a.categorical.values&&(n=a.categorical.values[0].values[0]),null!=n){var o=document.createElement(\"div\");o.classList.add(\"image-container\");var s=n.toString();if(r(s,\"<svg \"))o.innerHTML=s;else{var u=document.createElement(\"img\");if(u.setAttribute(\"alt\",\"\"),u.setAttribute(\"src\",t(s)),document.body.appendChild(u),this.settings.imageOptions.circle&&u.classList.add(\"circle\"),this.settings.imageOptions.borderWidth>0){var l=(e.viewport.width-2*this.settings.imageOptions.borderWidth).toFixed(0);u.setAttribute(\"style\",\"width: \"+l+\"px; border-style: solid; border-width: \"+this.settings.imageOptions.borderWidth+\"px; border-color: \"+this.settings.imageOptions.borderColor)}else u.setAttribute(\"style\",\"width: \"+e.viewport.width.toFixed(0)+\"px;\");o.appendChild(u)}this.target.appendChild(o)}else console.log(\"Image was null\")},i.parseSettings=function(t){return e.VisualSettings.parse(t)},i.prototype.enumerateObjectInstances=function(e){var t=e.objectName,i=[];switch(t){case\"imageOptions\":i.push({objectName:t,properties:{borderColor:this.settings.imageOptions.borderColor,borderWidth:this.settings.imageOptions.borderWidth,circle:this.settings.imageOptions.circle},validValues:{borderWidth:{numberRange:{min:0,max:20}}},selector:null})}return i},i}());__decorate([e.logExceptions(),__metadata(\"design:type\",Function),__metadata(\"design:paramtypes\",[Object]),__metadata(\"design:returntype\",void 0)],o.prototype,\"update\",null),e.ImageVisual=o}(t=e.vImage9A4E60DA8D8644E6856BE871F0717518||(e.vImage9A4E60DA8D8644E6856BE871F0717518={}))}(t=e.visual||(e.visual={}))}(t=e.extensibility||(e.extensibility={}))}(powerbi||(powerbi={}));var powerbi;!function(e){var t;!function(t){var i;!function(t){t.vImage9A4E60DA8D8644E6856BE871F0717518={name:\"vImage9A4E60DA8D8644E6856BE871F0717518\",displayName:\"VImage\",\"class\":\"ImageVisual\",version:\"1.0.0\",apiVersion:\"2.5.0\",create:function(t){return new e.extensibility.visual.vImage9A4E60DA8D8644E6856BE871F0717518.ImageVisual(t)},custom:!0}}(i=t.plugins||(t.plugins={}))}(t=e.visuals||(e.visuals={}))}(powerbi||(powerbi={}));","css":".visual-vImage9A4E60DA8D8644E6856BE871F0717518 .image-container{width:100%}.visual-vImage9A4E60DA8D8644E6856BE871F0717518 img{display:block;margin-left:auto;margin-right:auto}.visual-vImage9A4E60DA8D8644E6856BE871F0717518 .circle{border-radius:50%}","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="}}